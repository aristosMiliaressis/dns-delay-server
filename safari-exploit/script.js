async function run(wait) {
    if (wait) {
        await new Promise(r => { setTimeout(r, 100) })
    }
    fetch("/")
        .then(resp => resp.text())
        .then(text => {
            if (!text.includes("MyServerToken")) {
                return fetch("/secret.txt")
            } else {
                run(false)
            }
        })
        .then(resp => resp.text())
        .then(text => {
            alert(text)
        })
}

run(true)
